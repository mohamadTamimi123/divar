# 🚀 راه‌اندازی پنل مدیریت

راهنمای کامل راه‌اندازی پنل مدیریت سیستم املاک دیوار

## 📋 پیش‌نیازها

- Node.js (نسخه 14 یا بالاتر)
- PostgreSQL
- npm یا yarn

## 🔧 نصب و راه‌اندازی

### 1. نصب وابستگی‌ها
```bash
cd back
npm install
```

### 2. تنظیم پایگاه داده
```bash
# اجرای migration ها
npx sequelize-cli db:migrate

# ایجاد کاربر مدیر پیش‌فرض
npm run create-admin
```

### 3. اجرای سرور
```bash
npm start
# یا برای development
npm run dev
```

## 🔐 دسترسی به پنل مدیریت

### 🌐 آدرس‌ها
- **صفحه ورود:** http://localhost:5001/admin/login.html
- **پنل اصلی:** http://localhost:5001/admin
- **پنل کراولر:** http://localhost:5001/admin/crawler
- **مستندات API:** http://localhost:5001/api-docs

### 👤 اطلاعات ورود پیش‌فرض
- **ایمیل:** `admin@divar.com`
- **رمز عبور:** `admin123`
- **نقش:** Super Admin

> ⚠️ **مهم:** حتماً پس از اولین ورود رمز عبور را تغییر دهید!

## 🎯 قابلیت‌های پنل

### 🏠 داشبورد اصلی
- آمار کلی سیستم
- نمایش کاربران فعال
- آمار ملک‌ها و پرداخت‌ها
- گزارشات سریع

### 👥 مدیریت کاربران
- مشاهده لیست کاربران
- ایجاد/ویرایش/حذف کاربران
- تنظیم نقش‌ها و دسترسی‌ها
- فعال/غیرفعال کردن کاربران

### 🏢 مدیریت ملک‌ها
- مشاهده تمام ملک‌ها
- ویرایش اطلاعات ملک‌ها
- تأیید/رد ملک‌ها
- مدیریت تصاویر

### 💳 مدیریت پرداخت‌ها
- مشاهده تراکنش‌ها
- پیگیری پرداخت‌ها
- گزارش درآمد
- مدیریت استرداد

### 🕷️ مدیریت کراولر
- کنترل فرآیند کراول
- مشاهده آمار کراول
- مدیریت فایل‌های خروجی
- تنظیمات کراولر

## 🔧 دستورات مفید

### ایجاد کاربر مدیر جدید
```bash
npm run create-admin
```

### اجرای migration ها
```bash
npx sequelize-cli db:migrate
```

### بازگشت migration ها
```bash
npx sequelize-cli db:migrate:undo
```

### اجرای seeder ها
```bash
npx sequelize-cli db:seed:all
```

## 🔒 امنیت

### تنظیمات امنیتی
- استفاده از JWT برای احراز هویت
- رمزگذاری رمزهای عبور با bcrypt
- اعتبارسنجی ورودی‌ها
- محدودیت دسترسی بر اساس نقش

### نکات امنیتی
- رمز عبور پیش‌فرض را تغییر دهید
- از رمزهای قوی استفاده کنید
- دسترسی به پایگاه داده را محدود کنید
- از HTTPS در محیط تولید استفاده کنید

## 🐛 عیب‌یابی

### مشکلات رایج

#### خطای اتصال به پایگاه داده
```bash
# بررسی تنظیمات در configs/database.js
# اطمینان از اجرای PostgreSQL
sudo service postgresql start
```

#### کاربر مدیر وجود ندارد
```bash
npm run create-admin
```

#### خطای port در حال استفاده
```bash
# تغییر port در server.js یا
sudo killall node
```

### لاگ‌ها
- لاگ‌های سرور در کنسول نمایش داده می‌شوند
- لاگ‌های مرورگر در Developer Tools > Console

## 📈 عملکرد

### بهینه‌سازی
- استفاده از connection pooling برای دیتابیس
- کش کردن داده‌های پرتکرار
- فشرده‌سازی پاسخ‌های API
- بارگذاری تنبل در frontend

### مانیتورینگ
- نظارت بر عملکرد API
- بررسی استفاده از منابع
- ثبت خطاها و لاگ‌ها

## 🔄 بروزرسانی

### بروزرسانی کد
```bash
git pull origin main
npm install
npx sequelize-cli db:migrate
npm start
```

### پشتیبان‌گیری
- پشتیبان‌گیری منظم از دیتابیس
- پشتیبان‌گیری از فایل‌های کراول
- ذخیره تنظیمات مهم

## 📞 پشتیبانی

### منابع
- مستندات کامل در README فایل‌ها
- نمونه کدها در پوشه examples
- API documentation در `/api-docs`

### تماس
- گزارش مشکلات در GitHub Issues
- مستندات تکمیلی در Wiki

---

**🎯 این راهنما تمام مراحل راه‌اندازی پنل مدیریت را پوشش می‌دهد. در صورت بروز مشکل، مراحل را مجدداً بررسی کنید.**