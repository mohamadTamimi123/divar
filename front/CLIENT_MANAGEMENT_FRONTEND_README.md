# مدیریت مشتریان - Frontend

## 📋 خلاصه ویژگی‌ها

سیستم مدیریت مشتریان در frontend به مشاوران املاک امکان می‌دهد تا:

- ✅ مشتریان خود را ثبت و مدیریت کنند
- ✅ مشخصات ملک مورد نیاز مشتری را وارد کنند
- ✅ فایل‌های مرتبط با هر مشتری را مشاهده کنند
- ✅ تطبیق‌های خودکار فایل‌های جدید با نیازهای مشتری
- ✅ نمایش فایل‌های جدید با نشانگر "جدید"
- ✅ جستجو و فیلتر کردن مشتریان

## 🎯 مسیرهای Frontend

### صفحه مدیریت مشتریان
```
/admin/clients
```

### ویژگی‌های صفحه:
1. **لیست مشتریان**: نمایش تمام مشتریان کاربر
2. **جستجو و فیلتر**: بر اساس نام، نوع ملک، شهر
3. **افزودن مشتری**: فرم کامل برای ثبت اطلاعات
4. **ویرایش مشتری**: امکان ویرایش تمام اطلاعات
5. **حذف مشتری**: با تأیید کاربر
6. **مشاهده فایل‌ها**: نمایش فایل‌های مرتبط با هر مشتری

## 🏗️ ساختار فایل‌ها

```
front/
├── src/
│   └── app/
│       └── admin/
│           └── clients/
│               └── page.tsx              # صفحه مدیریت مشتریان
├── adminComponent/
│   └── AdminSidebar/
│       └── AdminSidebar.tsx              # سایدبار ادمین (به‌روزرسانی شده)
└── components/
    └── MainMenu/
        └── MainMenu.tsx                  # منوی اصلی
```

## 🎨 رابط کاربری

### بخش‌های اصلی صفحه:

#### 1. Header
- عنوان صفحه: "مدیریت مشتریان"
- دکمه افزودن مشتری جدید

#### 2. Filters
- جستجو در مشتریان
- فیلتر بر اساس نوع ملک
- فیلتر بر اساس شهر
- دکمه جستجو

#### 3. جدول مشتریان
- نام و ID مشتری
- شماره تلفن
- نوع ملک (با رنگ‌بندی)
- متراژ
- شهر
- بودجه
- وضعیت (فعال/غیرفعال)
- عملیات (مشاهده فایل‌ها، ویرایش، حذف)

#### 4. Modal ها
- **افزودن مشتری**: فرم کامل با تمام فیلدها
- **ویرایش مشتری**: فرم ویرایش با اطلاعات پر شده
- **مشاهده فایل‌ها**: نمایش فایل‌های مرتبط با نشانگرهای جدید

## 🔧 API Integration

### Endpoints مورد استفاده:

#### دریافت لیست مشتریان
```typescript
GET /api/v1/clients
Authorization: Bearer <token>
```

#### افزودن مشتری جدید
```typescript
POST /api/v1/clients
Authorization: Bearer <token>
Content-Type: application/json

{
  "name": "نام مشتری",
  "phone": "09123456789",
  "propertyType": "sale",
  "area": "100-150",
  "city": "تهران",
  "budget": 500000000,
  "description": "توضیحات"
}
```

#### ویرایش مشتری
```typescript
PUT /api/v1/clients/:id
Authorization: Bearer <token>
Content-Type: application/json
```

#### حذف مشتری
```typescript
DELETE /api/v1/clients/:id
Authorization: Bearer <token>
```

#### دریافت فایل‌های مشتری
```typescript
GET /api/v1/clients/:id/files
Authorization: Bearer <token>
```

## 🎨 طراحی و UX

### رنگ‌بندی:
- **فروش**: سبز (`bg-green-100 text-green-800`)
- **اجاره**: آبی (`bg-blue-100 text-blue-800`)
- **زمین**: زرد (`bg-yellow-100 text-yellow-800`)
- **مشارکت**: بنفش (`bg-purple-100 text-purple-800`)

### نشانگرهای بصری:
- 🔴 **جدید**: فایل‌های جدید با نشانگر قرمز
- ✅ **خوانده شده**: فایل‌های مطالعه شده
- 🎯 **امتیاز تطبیق**: درصد تطبیق فایل با نیازهای مشتری

### Responsive Design:
- طراحی ریسپانسیو برای تمام دستگاه‌ها
- جدول قابل اسکرول در موبایل
- Modal های مناسب برای موبایل

## 🔄 State Management

### State های اصلی:
```typescript
const [clients, setClients] = useState<Client[]>([]);
const [loading, setLoading] = useState(true);
const [showAddModal, setShowAddModal] = useState(false);
const [showEditModal, setShowEditModal] = useState(false);
const [showFilesModal, setShowFilesModal] = useState(false);
const [selectedClient, setSelectedClient] = useState<Client | null>(null);
const [searchTerm, setSearchTerm] = useState('');
const [propertyTypeFilter, setPropertyTypeFilter] = useState('');
const [cityFilter, setCityFilter] = useState('');
```

### Form State:
```typescript
const [formData, setFormData] = useState({
  name: '',
  phone: '',
  propertyType: 'sale' as 'sale' | 'rent' | 'land' | 'partnership',
  area: '',
  city: '',
  budget: '',
  description: ''
});
```

## 🎯 ویژگی‌های کلیدی

### 1. مدیریت مشتریان
- ثبت اطلاعات کامل مشتری (نام، تلفن، نوع ملک، متراژ، شهر، بودجه)
- ویرایش و حذف مشتریان
- جستجو و فیلتر کردن
- نمایش وضعیت فعال/غیرفعال

### 2. مدیریت فایل‌ها
- نمایش فایل‌های مرتبط با هر مشتری
- نشانگر فایل‌های جدید
- علامت‌گذاری فایل‌های خوانده شده
- دانلود فایل‌ها

### 3. سیستم تطبیق خودکار
- تطبیق فایل‌های جدید با نیازهای مشتری
- محاسبه امتیاز تطبیق (0-100)
- معیارهای تطبیق: نوع ملک، شهر، متراژ، بودجه، محله

### 4. رابط کاربری
- طراحی مدرن و ریسپانسیو
- نمایش آمار و اطلاعات
- عملیات آسان و سریع
- اعلان‌های واضح

## 🚀 راه‌اندازی

### 1. بررسی نصب
- وارد پنل ادمین شوید (`/admin`)
- به بخش "مدیریت مشتریان" بروید (`/admin/clients`)
- یک مشتری جدید اضافه کنید

### 2. تست سیستم
- چندین مشتری با نیازهای مختلف اضافه کنید
- فایل کراول جدید ایجاد کنید
- بررسی کنید که فایل‌ها به طور خودکار تطبیق یابند

## 🔧 تنظیمات

### Environment Variables:
```env
NEXT_PUBLIC_API_PATH=http://localhost:5001
```

### API Configuration:
- Base URL: `process.env.NEXT_PUBLIC_API_PATH || 'http://localhost:5001'`
- Authentication: Bearer Token
- Headers: `Authorization: Bearer <token>`

## 🐛 عیب‌یابی

### مشکلات رایج:

#### 1. خطای احراز هویت
- بررسی کنید که توکن در localStorage ذخیره شده باشد
- بررسی کنید که توکن معتبر باشد

#### 2. خطای API
- بررسی کنید که سرور backend در حال اجرا باشد
- بررسی کنید که API endpoints درست باشند

#### 3. خطای نمایش داده
- بررسی کنید که داده‌ها درست دریافت شوند
- بررسی کنید که state ها درست به‌روزرسانی شوند

## 📈 آمار و گزارش‌گیری

### آمار فایل‌ها:
- تعداد کل فایل‌ها
- فایل‌های جدید
- فایل‌های خوانده شده
- دسته‌بندی بر اساس نوع

### گزارش‌های مشتری:
- تعداد مشتریان فعال
- مشتریان با فایل‌های جدید
- آمار تطبیق‌ها

## 🔄 به‌روزرسانی‌های آینده

### نسخه 1.1:
- 📅 سیستم اعلان‌های ایمیل
- 📅 گزارش‌گیری پیشرفته
- 📅 تحلیل داده‌ها

### نسخه 1.2:
- 📅 موبایل اپ
- 📅 API عمومی
- 📅 سیستم امتیازدهی

## 📞 پشتیبانی

برای سوالات و مشکلات:
1. بررسی مستندات کامل
2. بررسی لاگ‌های سیستم
3. تماس با تیم توسعه

---

**توسعه‌دهنده**: تیم Divar Admin  
**تاریخ پیاده‌سازی**: 1403/10/17  
**وضعیت**: ✅ کامل و آماده استفاده 